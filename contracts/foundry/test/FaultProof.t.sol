// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.24;

import {Test, console} from "forge-std/Test.sol";
import {ModelRegistry} from "../src/ModelRegistry.sol";
import {ChallengeActor, FaultProof} from "../src/FaultProof.sol";
import {SP1Verifier} from "sp1-contracts/src/v4.0.0-rc.3/SP1VerifierPlonk.sol";

contract FaultProofTest is Test {
    ModelRegistry public modelRegistry;
    FaultProof public faultProof;

    address internal verifier;

    function setUp() public {
        // setup contracts
        verifier = address(new SP1Verifier());
        modelRegistry = new ModelRegistry();
        faultProof = new FaultProof(
            modelRegistry,
            96000,
            100,
            verifier,
            bytes32(0x003c3908eb935f439e0c8a25e55c146d67a7d028c98311d4e85c37e709af3ebd)
        );
        // bytes32(0x00db91d1a154e060ea9599fb79d7bece653a6bfb236d09e99502b3798749eb10) - for the commented tests (vk)

        // register model
        modelRegistry.registerModel(
            "ipfs://QmRtugH4D27AaJZMKBqPX4oyR2f3ZMykF3bMuSLNsccpbc",
            bytes32(0xf0c4b404383d6a9cf9cd220237b3c5dad9e410e7fdca48ac58f66e94b5c31624),
            5
        );

        // request inference
        modelRegistry.requestInference(
            0,
            hex"14bda63f1b54ec3ff886ecbf4f6461bfc687fbbf9965da3ed8b468bd80b5ee3fdf67fbbf1984a13e481fc83e9c41763e4da335be4ae4123e46796ebe4a96563f30e427bfda4727c0ea8f743f7cd6033fab539abe3314c13fba2e3ebf298c023fea7eedbe25fc0140fd4d083f4c0950bff8aa71bce0c81abf7f55823ff45db43f3dd60d3f7332bc3df46f483e49a1043fa7d88fbf23eb1c3f314175c0fbc28fbea05fd33f7ba710bfc6bef83ec43e7ebe5bf338bf4d0384bf33ff883e47f78ebf6adb80be9df5993f1396b9bedc3d3cbdf004d2be11ba1cbf416a06bf16d51fbec5ce933f518f4d3e041e0a3ff80f9b3fad4bc1bf1c39d0bd6902753efbae59bf7c7d94bf74c535bf7092f8bfa1841ec092bb523fa1acee3e34f5b23f135aef3f76992cbff71ea13fe96c4ebf73b9a6be4dca8a3ed0eaa73fb03c69bf5c419fbe988112bfb6b6f3bff7b10d40a28b6c3f9dd6823e809e4cbeec44353fe0b53abfa6810c3fe5f990bffbe46dbe0c33aebf675e473d88c30d409f6d943fe4d6d33f603c043f0d25e8be478facbf002d643ee75519bf29d46fbfa72f19402f01b83ec246453f588fd73f84c9dd3fe22353bfa1c81cbe4e9035be9564d83c4dcec13d6e639bbf776c993dc72c6cbe0896203f8f3b813ffdb6b13fdc1f9bbf137b48bfded71340a4740dbfed17ddbe7e83773f3f588cbf5d30bcbf2aa807c0c09d5d3ff7276bbff508973f06ba8b3fe953c23f0eb14abf333e533fd30f213ee8510b3f2935543f2116a43e5a046b3f3f095ebf4c5fdebe1ce6aebe4dc1a9bff139a4bf2beb76bf6754febe20c81a405cfca2bedbc33e3ee56957bfcd6f12bfdaa45a3f4fc2513ffbb92a3dd2c08f3f6701603f4acb5abf78a4f63e59023d3fd8c7873f6ade983ed635d2bf7c6547befd38b4bd2d6d8f3f46a37cbfd2e597bfff5cbdbff32c02c057777e3f21dc9dbffcdbbcbf2777853d11371dbf49af303ec1a5c53f0f631fbd452cfe3dd02d2ebfe6e9e43d1a0dd7be5d0964bf11f900c00cee9c3fdfd25e3f79dacfbf6209b53c72dacb3f74edd53eab2a95bfe74891bf18928a3e8ec23140b551acbf3025873eb7092abf46e0013fac64d4bf013686bee916353dd2040440fd72b2bf5a3d043fe45c853f338484bfdfe770bfcf59e2beb90eb3bc13e480bdab8b76bf04552b3f34b51a4015c60a3eeadc7abf5fa25bbf5a1ad2bff683583f101289be31944d3edf8fcd3f9b81d1bfbeceb53e135a46bfd4a592bf286c023f7876903e67f1b93c7c070d3fc107643fea2bb8bec5d979bf30c90240438bad3d3c8582bffcf3b7be9377d23fd80e7ebf1ee04c3fbd9075bf00c4753e1c828ebe2332cfbf4245a63ffdbc443f08cd2fbf7e9b34bf453accbf1df7cebfb5eb2cbff96201c003124a3f5b8dd03f18bdc33f1e8defbddb7649be841578bf96fa083e4da8073e1998a9be421e52bfa75e183f4c5585bfc9cb5a3e72bc0abf99670bbe28c6133fab12b33fe6c6ffbed4e8c3be2f589ebf30a10d3fcea07ebebfa0393fe82bc9bd21fa123de09624bf01be33be3134babf5a6bd5bf6d0e4ebe7aa104c0f11ca03f0e06c63d1bfaa7bf1d5cc43ef1ad02bf137b353e5c24783f3d40883eeef7833f2b2a383fd2a2343fca8f713d7f8fe1bfb05dc2bf7e1010c0daa769bef5c2f53cf04602bfc39aaabfc7f07dbf751f2f3fa195483fec40033fe2817ebf318def3f1b27e43cdbe3fe3e970b72bf03eba93fb52fb43e99b3f33e17d773be64228b3f0fecc33ee0ed333ec992d8bef4d0d93e6da9ccbf36f9ce3e4db3833fa3bb88bf2e08533f40b6cabf123dcbbeae5a8d3ffb2393bf4d7697be9e6c32bf44283dbfc458d0bffda9bcbf86a157be96db65bf3245bdbf79b98dbf8c8a83be328a4abf41e8943f7f3a40bfc6f708bda428cebf621eb43fef923f3ee3b0b23f9f36d83fd4b106bfbde31cbf66dab4bfe6db683f59db063f6fe9cf3e8321b9bf00bf433fdb61653fc704aebd058a773e32883c3feee705c0f8fb9e3f6f109abdfcd8863ff3151abf1f594dbf3c8b4dbfcd2dcebe575f103fddb0dabf050857bcdb66b73ff5b22e3fb94b99bfafea14c057f1c13fbf34fdbf65dababee51ca73e215891be4034f6bedb437abfbbcc613e330b6a3f038b1bbe0960e4bebdb1e3bddf13633fdb3b92bfe17b35bfd4ba883fb21ffdbee9778cbf786accbf02bf893ee0b9c73e8407bebec0e571bf7b48e2bf15e17f3f21dd3ebf5007c03e7a3c5d3ea32a36bf24b871bfdbbb87bf0e415abe98aad0bff8ae473fcc39a33fcb06ae3f9e5c85bf965d1d3e4d825d3f1652d43ff8a2383e5df7533fbf8f2a3fad463fbeff03e63ff141b2be43abd6bf1d3d6e3f6b81073f8cf276bfdf5324bed892323f979a133f5e57ddbcd21b89bf430237bf3b130e3f29d10d40a8ae903fe823c13e803a09bed86a703f362778be71090dbfee0968bf329ceb3edae04fbf2a0d1c3e4a07ff3e151e1fbf213087bf83aeec3e94b60cbfe0af0fbe19110b3f227f543f609c66bcf7936d3f4f2ee4bee0bbb43fdf5c303caf1f8dbfef54b7bf0ef0f3bd9580083f5cfb143f5186f53f9aa00640382369bfd3b3ca3f10122fc0e43fd53fcc9344bfc331cd3fe50c273db3c9a63efb3a97bcfdcc433fdf9c45bfabd4abbf036291bf1760893e7b5cfc3e51969a3f31e112bf20a1213e72e6923f09a2513e9d12f4bfe06135bf1f7794bf283d13403dffeb3ec0700fbf1d49823f4b6daa3e7f58b43e4fffb9be049087bfaf79c43ea08ef6be2c1a403f7f565ebe7adf2ebfd2bfdebe30aafabd1d95a9bfb3b3853feadc9f3fe089b2bf37f0c83d82d49b3e11c549bcbc3ca93f3619933f8d67d2bfa8d3243fe3b3e23c8eaed23ecb68743fcdd335bff72eafbf48aabd3f127f613fcbbf033e485052bed3fb28bf8e15abbf3e4d31bf79aab53d476a90bf39fb8a3fc5dfc13e1cdd4abe79e34abf152aa6be98cf2a3e061c01bf13b4a43f3ccf3fbf380b06c04da3393f6c8986bf0d0f363e93990c3f5a833dbe53ccd6bd77842c3fb70c0d3f679892bfe9e090be56030d3e328f42be541ea13d91aa54be0cd907c07566c13f0a47653d398f59bf483ec13e79b7243fe52bbf3f209a9abfc53f47bf14c2cfbf9aa9b8bdd1c4503ff5198a3ee1eaa7be1919383f35de47be1ba19dbf3677d4bf21b7ed3e5bd87bbeb4124e3f869d5cbf02ada4be3e2329be6a31f9be5017cebe1bee8ebe8a05803fe9892ac0cf6bc43f7115dd3fdd813a3f52f992bff2aa913e4ebc773f061c32bedeec1c3e1f34043f5efa7bbf9f73953ee8400a404861993e64c21bbc301696bfcb314f3f06f5c73fde72fc3e184a183f8602b2bfcafbedbe1655b2be64eab03feda5b83fcd158cbfa7018bbfce30163fbc07533f25fd2cbe0016053f152e57bfff9266bf8e4c653fda2d903eaf04c3be400dc93e911932bf88b7c83e322801c07a100fbf19b216bfd2a1303ed6d658bfc5d5d63f0a3e8b3fa511c13e18eba03f443c104070e0e13ed366803f4947083da20a45bd470c123f7d7fd63fe21869bf756702bf005ff3be70e6d13e28e73cbf8c8319bfc2fd10beb354b83ed7dabdbec4d36640f18565bd103706bdc9cc4abfeb26b2bfc58903c034373e3f4c4b053fd90c923f78adbd3e3cee913fe5cdf43f42d5f53e1fdb4f3e03d963beb3dafebd27807d3d4c1604bfaab948be677f0f3ed34b153e0be604c0e722713f1c2056be121de23ce289743f7356f8bf75df453ee4e99d3f3dc90ebf175384bd0a61b0bfefb13bbb877e2abf2df255bf63f488bded980040f067b5bfc2d4413f1cff193f36f29d3e334337bf2067ce3fb3d172bf6d9684bf528a653f1eef2ebf08101c3edcc177bf76ef2abd68000ebfe4902e3f08a51fbe3260a9bffd9949be6411863fb1df69bfe5e5733f2748fa3fc4e2953e5f0b78bf26c5133f155800be859bc6be348d953f0d04ccbff65e7dbf96fd783d37f3b4be6eb5b8bee84aa53f0fcbdabd620e143fae8c73bf8fd68dbfe96d57be8cf925bfe3d2aa3f6bed69be2557043f988e4abf17f80fbe4a44d5bfbb3f0dc0623f10c02f816ebf6416a0bebed3a3bd46d0e83ffc7ac03f9500133f814205bf502ab23e5af684bf8145bdbfcde66d3eadac6a3fd751a03fda2fa5bf8b2160bea74859bf8319b43fc78c213f11d9a73e7b15363fc63b0340dcef96be9c31913f887a7b3f4dbde33ff7f22c3fa4679c3edc380d3f75fa943f391928be0d52b0bf55b49c3f102d20bf96ed7d3f7e78e6be7e85e6beb7aa94bec46d60be8f70473eda173d3edb2129bfd6655a3fcac579bf4bf3923e3c5278bf180da83efa1125402bdc89bfb4722c3da7963fbf7af6ba3e106e073f54e180bf32c6aa3e80b4b33fb46c94bfdee36a39b4b3e7be07bb08c0",
            bytes32(0x923edd4e1f7ea9f2641c09e4dd2bf672e09970eec48cac0f484c3f6657f7c044)
        );

        // request inference 2
        modelRegistry.requestInference(
            0,
            hex"7b22636f6e76732e302e776569676874223a7b226474797065223a22463332222c22646576696365223a22437075222c227368617065223a5b322c312c332c335d2c2264617461223a5b302e31393330363633383833363836303635372c302e31363732323336303235333333343034352c2d302e313230343438393931363536333033342c302e31323834323431393734333533373930332c302e30373038313231303631333235303733322c302e30353732343433393032343932353233322c2d302e333238333131323934333137323435352c2d302e30333836373734353339393437353039382c302e33323532393731343730333535393837352c302e32353638333936363237393032393834362c302e31353630323839383539373731373238352c2d302e32333632363032323034303834333936342c302e31333633343531343830383635343738352c302e32323538303937383237343334353339382c2d302e31353437333130373939333630323735332c2d302e30363238363739393930373638343332362c302e313731333737373438323530393631332c2d302e31363734303233313231353935333832375d7d2c22636f6e76732e302e62696173223a7b226474797065223a22463332222c22646576696365223a22437075222c227368617065223a5b325d2c2264617461223a5b2d302e31353331343332313231393932313131322c302e30363238353437333730343333383037345d7d2c22696e707574223a7b226474797065223a22463332222c22646576696365223a22437075222c227368617065223a5b312c312c32382c32385d2c2264617461223a5b312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e302c312e305d7d7d",
            bytes32(0xbe7c9f3b068911bc4e4f0a92253667a8661b250d2f82cc6f402efd7563939834)
        );
    }

    // Submitter did not correctly compute the fourth ONNX operator.
    function test_FaultProofStep4() public {
        // respond inference (wrong output)
        modelRegistry.respondInference(
            0,
            hex"4a1c883e4892983e79a1a9bd8d289ebefa1f7ebe6234f43deb8a433eae4c85bec73b3e3ddcf11ebe266d0ebec2e9b53ebc5df1bd61b0fabe0dc74e3e9e8158be32b86c3d3ce0d1bd515b013db4d9433df80ebcbc8bfcd53dfc6d53be8378c9bd3ff9173d1e32fa3ca81f3dbe22cc953e5faaa23d1fa682be22b126bdd3362c3d06dd983ef0ca39bee8a62d3c051e8b3e072fcfbc2e7ffabd74e9d93d6e15083d0efcb0be840b76bc09ea603cd4aa763d3cc7cd3c9c0eff3d0aa1013ecdc70a3e11b8e5bc702a73bd31f0373f027e363eeaf5803e1134e0bea739a4bdeecc633e2ba6533d34deb43d823244bf327ed63da0a0e03d507e85be61c80b3d82d4fe3d4888c7bd1c9e77bc4f3abcbcb8233bbcd4f1adbe17c11d3ea4cc31bd1630a1bcf0c2d0bd7c2592be9d2c7ebe0b4d81bc9e5521be2b3bc4bd0f50bf3dda60923eee321dbc75253cbeac76ed3d9bbed23d40063fbbd88d47be682a403ec140ad3d385d48bd60e3123e34b7f03ea869ba3d8e22e03c5bd1283ee0ecefbdd800363d7e8a003e8445903eda0afbbd0ae13d3e",
            bytes32(0x86f1c59c8509db81bd563c58bb57d487f9cb8f23a1bc4d2b4cf6614977fa94d7)
        );

        // create challenge - CHALLENGER
        faultProof.createChallenge(0);

        // propose operator execution - CHALLENGER (operator 2)
        faultProof.proposeOperatorExecution(
            0,
            bytes32(0x95541f66f0e41e0c1171aa42ec191eca98a6d903132fb5c56247999d5d1c846b),
            bytes32(0x6d3164945367c04f13830f4ba37d644bdcc907e0144241a03a0b2eddac1402c4)
        );

        // respond operator execution - SUBMITTER
        faultProof.respondOperatorExecution(0, true, true);

        // propose operator execution - CHALLENGER (operator 3)
        faultProof.proposeOperatorExecution(
            0,
            bytes32(0x6d3164945367c04f13830f4ba37d644bdcc907e0144241a03a0b2eddac1402c4),
            bytes32(0x5eeb0b5a8234f400165fa0420bcddf71e1de0b7496b6e5ef7df5b7f643b12aef)
        );

        // respond operator execution - SUBMITTER
        faultProof.respondOperatorExecution(0, true, true);

        // propose operator execution - CHALLENGER (operator 4)
        faultProof.proposeOperatorExecution(
            0,
            bytes32(0x5eeb0b5a8234f400165fa0420bcddf71e1de0b7496b6e5ef7df5b7f643b12aef),
            bytes32(0x86e1c59c8509db81bd563c58bb57d487f9cb8f23a1bc4d2b4cf6614977fa94d7)
        );

        // respond operator execution - SUBMITTER
        faultProof.respondOperatorExecution(0, true, false);

        // resolve challenge - CHALLENGER
        faultProof.resolveOpenChallenge(
            0,
            hex"f0c4b404383d6a9cf9cd220237b3c5dad9e410e7fdca48ac58f66e94b5c31624010000000000000004000000000000005eeb0b5a8234f400165fa0420bcddf71e1de0b7496b6e5ef7df5b7f643b12aef86e1c59c8509db81bd563c58bb57d487f9cb8f23a1bc4d2b4cf6614977fa94d7",
            hex"1b34fe112bee0c1c35a5ecdb9ebd642daf0decdefeb1c6aca62a1db8e4b5383b0ac1af640de847996e6ae1ad338bcec384c77ba952fc51fbce7eab613056c891d9d2f23f1ff14c8d0c19668e549bcaf31c789cf949a1d0c67eb0c26e1cff7f11166779991bc8cdb7e740bee0b3c6363f24e3e73acd8696417e6f2cf8469d04a5ee6153c72ddecbd83359bdf000c09572dac0f6af28e08b797ea4b17be9ed31dbce8802f819982e471bf5cd12a3df7fab1242801d267092009ae9b71ccff5bf7b89e5ee712234d8064f068dba8de85fb6f9640bcef3bdd28b96db8c5d251f67d153a0d3fd2476f06ac69581be875e36f4e40d883d9bf68ce5449a84c7c2a2da98ff1081230adb607728220d42754aab35855cf3f046106543bc92984f6fad9d0af54623eb294fab0cff1a079d635307e455281acebe658a8ce1aa11a8ecc56ee98f4617732ad04d283026c5b97dba5bb90d805e03e4eb5105385c412b3f334833556640d81e35402464e153148d93d14eb8179d8a22e46399230e43bca63790313b8008a81ecde068d7466bbe0bf56bc5ae7de081df2660a310b175f06d9e8e0af0b6d96d08ede25c89b1420ccdfcf0761a264741c13d56d48e5b15532db3d4f48001c31c09eac867028abb907dc3f455a5ed23cc5563f3478fadc42a8749e872f27b462903e19a086addfa88c4a70ade994927e9b14ab42c36b5914ff6370e5a783dd0a6182beb5b719c8e62b023977e9bc5bd46f4b7190f608fcabc28e803fc9f382bad0067aadb0c749920b9c9accff058e57ce2d691ea6ed48a0fd3ac0c212ec6d9511f02fa87a6b52dfdab7c1d46155622605f700c1492da3eded094c2f2f753abd72c92f8ecfb9373856a1206a732dcda7e81fe108d5e39d690cdaccaa982ed8ff42fbf9011aa0648754dd803e605112eec102e9e04da225640058fe19ca2845fc41d97e8294b1a93e2508228dce5ed730a5aaf0f13a11b9d2bc6cb4a3687eaf56317ce54844d8eb4f1c7a16ff2be9757a27c4ae737fa0d290de88fce278b3dec281b206313e36699bc7653dd5ae92d351f33aaf7386c84b73d82368dcf00b5217723e312e9dc67742efe7ee7fdb407d4e05261be3e0173a3be65a0d3b2ae3e54cd25fb98ae70fe296d9479e4b72e8023c3b2cace7b414661d2d6eda46e8df7cbb01820c12f3bc74010eabd36597ccb6333f0ed68b3fe02421f0335dcbc8f9f071e"
        );

        assertEq(uint256(faultProof.getChallenge(0).winner), uint256(ChallengeActor.CHALLENGER));
        assertEq(faultProof.getChallenge(0).resolved, true);
    }

    // Submitter did not correctly compute the second ONNX operator.
    function test_FaultProofStep2() public {
        // respond inference (wrong output)
        modelRegistry.respondInference(
            0,
            hex"4a1c883e4892983e79a1a9bd8d289ebefa1f7ebe6234f43deb8a433eae4c85bec73b3e3ddcf11ebe266d0ebec2e9b53ebc5df1bd61b0fabe0dc74e3e9e8158be32b86c3d3ce0d1bd515b013db4d9433df80ebcbc8bfcd53dfc6d53be8378c9bd3ff9173d1e32fa3ca81f3dbe22cc953e5faaa23d1fa682be22b126bdd3362c3d06dd983ef0ca39bee8a62d3c051e8b3e072fcfbc2e7ffabd74e9d93d6e15083d0efcb0be840b76bc09ea603cd4aa763d3cc7cd3c9c0eff3d0aa1013ecdc70a3e11b8e5bc702a73bd31f0373f027e363eeaf5803e1134e0bea739a4bdeecc633e2ba6533d34deb43d823244bf327ed63da0a0e03d507e85be61c80b3d82d4fe3d4888c7bd1c9e77bc4f3abcbcb8233bbcd4f1adbe17c11d3ea4cc31bd1630a1bcf0c2d0bd7c2592be9d2c7ebe0b4d81bc9e5521be2b3bc4bd0f50bf3dda60923eee321dbc75253cbeac76ed3d9bbed23d40063fbbd88d47be682a403ec140ad3d385d48bd60e3123e34b7f03ea869ba3d8e22e03c5bd1283ee0ecefbdd800363d7e8a003e8445903eda0afbbd0ae13d3e",
            bytes32(0x86f1c59c8509db81bd563c58bb57d487f9cb8f23a1bc4d2b4cf6614977fa94d7)
        );

        // create challenge - CHALLENGER
        faultProof.createChallenge(0);

        // propose operator execution - CHALLENGER (operator 2)
        faultProof.proposeOperatorExecution(
            0,
            bytes32(0x95541f66f0e41e0c1171aa42ec191eca98a6d903132fb5c56247999d5d1c846b),
            bytes32(0x6d3164945367c04f13830f4ba37d644bdcc907e0144241a03a0b2eddac1402c4)
        );

        // respond operator execution - SUBMITTER
        faultProof.respondOperatorExecution(0, true, false);

        // resolve challenge - CHALLENGER
        faultProof.resolveOpenChallenge(
            0,
            hex"f0c4b404383d6a9cf9cd220237b3c5dad9e410e7fdca48ac58f66e94b5c316240100000000000000020000000000000095541f66f0e41e0c1171aa42ec191eca98a6d903132fb5c56247999d5d1c846b6d3164945367c04f13830f4ba37d644bdcc907e0144241a03a0b2eddac1402c4",
            hex"1b34fe111811160da2539fcc0f18a46560e87edf0463651475e3188df365f2db0185095c16978146a97f7c67a4613ca7813713b3c9d0ef74573bc53f6479eff18e7559dc0fd9b9a70adae8e1234ec5e97ab0f3bdf4b81718c70e220df454f17dccdfbae32b5510787a93ff0a6de93025f46bd535ec6d703c4132ffe1f6901c73243a42181fe698ab33cac5fb2ead9b699a6df9d24b5a97d60e908594feb4aabdaff123cb08e8a700dc37376efe36e98ea7852300299102c7975a688d743e82229d08fc7f28568dc96b7840e2a970225410d0f55fdb3980efc4a1fb9e89f1e6aeb088c44d10d6baa626261e63079f1d9aae312e068a8719bfb025cb29c462a023e65a156c0c6e333d2ade70ac4f0d42b1c621bcd540f1c75ac79392902eefc7df34a483342a6e15280fb267f664cdd7d6e5fc37f12a18538bdd66d5b7d207857c629819451bd014bbc85f117e10efa6e6c5b8d29b3ffcb8f4c01fe206972c01e903fe85040e4448c80bdab2595638bed8a791413c859c52e326754380d9a6201e9992589f119873f5208c9408bd88e73205890932d568c1c7c6a2ec0b904b540d8c43243c01f008e5cdf45a1cec118d05bbd0e4eb46db6a964444df2d8633b3c68d238132023dc64b79809ac0674fa1553269bf5a190730f555114cc6dda2a8e18807055004c9f69826d5b89b110aff9212f324c5c6c86891fbfdffa0d4da602d5f19e21b15dd178cf2f932fd21aa04f9be08fc18ee73ce73e4a01df98ba027bf669c392e284e5952f80ebda5ed959fc12766000d97dd9e0b18c043a0efeab7b5bc4aa75704ac65fea6b9450d255ea831b23c829757f2ac44bc720d7cf74b855d85ce18c72751f7fac65eba474d42d83fcbe51f859296774debbbbd2ae9b0c5cf3e17c9ea06e139f6b183118b68f8710444086d795108bc2d697e8e806f34ada7d1383406108138a98de46f9b73b508f114cba9a1939bb34abdc159552a4c1f15505fa0be25a6c475f00ac446714be6346fac8c3cda8573e68b50e19aa3ab83ea43f36adb2e1b49b41786f7c3faef7dd2c93b6fa3c1dd2b56fa39e30dc458aebfbbe2d37326eec56330a521242c28c73747654e22b06319baf1843eca032ac43bcc5ca607136ef28d0e0438260ee221dd1bbcffb37c4b9712794f910b20525256b58a88132cb02460a18a84e25d6d92436a3b8778f817defa6cfdc481f701fbf2d9f64607"
        );

        assertEq(uint256(faultProof.getChallenge(0).winner), uint256(ChallengeActor.CHALLENGER));
        assertEq(faultProof.getChallenge(0).resolved, true);
    }

    // Submitter did not correctly compute the first ONNX operator.
    function test_FaultProofStep1() public {
        // respond inference (wrong output)
        modelRegistry.respondInference(
            0,
            hex"4a1c883e4892983e79a1a9bd8d289ebefa1f7ebe6234f43deb8a433eae4c85bec73b3e3ddcf11ebe266d0ebec2e9b53ebc5df1bd61b0fabe0dc74e3e9e8158be32b86c3d3ce0d1bd515b013db4d9433df80ebcbc8bfcd53dfc6d53be8378c9bd3ff9173d1e32fa3ca81f3dbe22cc953e5faaa23d1fa682be22b126bdd3362c3d06dd983ef0ca39bee8a62d3c051e8b3e072fcfbc2e7ffabd74e9d93d6e15083d0efcb0be840b76bc09ea603cd4aa763d3cc7cd3c9c0eff3d0aa1013ecdc70a3e11b8e5bc702a73bd31f0373f027e363eeaf5803e1134e0bea739a4bdeecc633e2ba6533d34deb43d823244bf327ed63da0a0e03d507e85be61c80b3d82d4fe3d4888c7bd1c9e77bc4f3abcbcb8233bbcd4f1adbe17c11d3ea4cc31bd1630a1bcf0c2d0bd7c2592be9d2c7ebe0b4d81bc9e5521be2b3bc4bd0f50bf3dda60923eee321dbc75253cbeac76ed3d9bbed23d40063fbbd88d47be682a403ec140ad3d385d48bd60e3123e34b7f03ea869ba3d8e22e03c5bd1283ee0ecefbdd800363d7e8a003e8445903eda0afbbd0ae13d3e",
            bytes32(0x86f1c59c8509db81bd563c58bb57d487f9cb8f23a1bc4d2b4cf6614977fa94d7)
        );

        // create challenge - CHALLENGER
        faultProof.createChallenge(0);

        // propose operator execution - CHALLENGER (operator 2)
        faultProof.proposeOperatorExecution(
            0,
            bytes32(0x95541f66f0e41e0c1171aa42ec191eca98a6d903132fb5c56247999d5d1c846b),
            bytes32(0x6d3164945367c04f13830f4ba37d644bdcc907e0144241a03a0b2eddac1402c4)
        );

        // respond operator execution - SUBMITTER
        faultProof.respondOperatorExecution(0, false, false);

        // propose operator execution - CHALLENGER (operator 0)
        faultProof.proposeOperatorExecution(
            0,
            bytes32(0x923edd4e1f7ea9f2641c09e4dd2bf672e09970eec48cac0f484c3f6657f7c044),
            bytes32(0xaaa40114be972f2938b2d45de293ca5942d247aadfc627e6caea6fc9f8dbae96)
        );

        // respond operator execution - SUBMITTER
        faultProof.respondOperatorExecution(0, true, true);

        // propose operator execution - CHALLENGER (operator 1)
        faultProof.proposeOperatorExecution(
            0,
            bytes32(0xaaa40114be972f2938b2d45de293ca5942d247aadfc627e6caea6fc9f8dbae96),
            bytes32(0x95541f66f0e41e0c1171aa42ec191eca98a6d903132fb5c56247999d5d1c846b)
        );

        // resolve challenge - CHALLENGER
        faultProof.resolveOpenChallenge(
            0,
            hex"f0c4b404383d6a9cf9cd220237b3c5dad9e410e7fdca48ac58f66e94b5c3162401000000000000000100000000000000aaa40114be972f2938b2d45de293ca5942d247aadfc627e6caea6fc9f8dbae9695541f66f0e41e0c1171aa42ec191eca98a6d903132fb5c56247999d5d1c846b",
            hex"1b34fe1103e27e7760a40818ee577fc0fa2b14adb7447c52a8635e175c31ee5036f0674912f5f60bf932816ff35ae62454b7c214447677a98dbf48775c735253afb721311e5b3f37cf66eb2ea2c90fd49fb2fc846a3a6e7cd31b4430ccaeb71fd822b7c6129fdd4a07a104df777ac3a1c1aeb01765aa84aca4bbb0d7e2da39cfa7f9d47f0d0edabf6a462c05372ea1a4449885342a9d5023597f12a1cfa4dda1188831390b1057653ed2f1bbdf44a8795f3198a088ef3d1a80268a67d306134da3c5162d1dc2e7391c955da5d1bfa652057c72be9af490b16e28cf7189f02a05c9b53de211a83c45104c2419d4a180e130cf2a5197f5e1c808c848f1b95b9c39dabab059114dceb9c435c1292d3d2a1ffcff5a63b5c9a40a061018d4a51131f2632257bc062dccd53cf48ad7fb83e2853b323e252434b511fb0da9177e4d783801910c940dc3fa7b9ffb8560463285ebd4bd67863069179c2dc36c787dfac162a04d76901bf2b3a1291341bf16d10871aa49ac42587edfa46fe9f6f3921e2be8426bf5462c9a810512470c4d9f9e6ed76319d83cb00a625541e4efe84f0e1721fa37a6442eb7ffc451ed29d83ca45a888a457085a3a4ffdab095cd750a5736a6e2677e0910449785bc12c7a969ee7cbff5dfd6b6562c805c529af0c58b0c7dfb06a77b0c2d11d2e4a7c38d198dbe563fcc4dd1f869c46cdb1e4dbf5f71388fbf0e4471111fa35202d7c3524da6ad7d2259af61986624bdac616314fa1c16d1c14f245ff406d7026f21e97c043500b26ef5e3995ac37b05b148fa2d5d7fe420d877918fc21e7fe7884f0aa08fa299e1ef441842dd95b4059ca0ec1fee4aac3d701d8f5ed926a19e608995adb5a63b1a53311142c0fbdf8f22e32e0e30c16be0794e087bb20907cb1cdd44b9724b06719747953ab9444968a899f1b6d8cab995b842c752d22a70a588e79f5aca8ce0fd8eb65abbc68add0ed53f604f603b42c0ee76c4f624188113831aafc0a735871fe5ee9048cd8fb5fe100f8898fd29b65240d6e780d41bd1bb27a512c8ab4d2435148f2e8abc61550aa8a50802744d85a496d6def9452e6d07e7c66310c31f262edab7645e8b6f0456c4f7b39c7d846d6a4cf07abd3f285a79c0136de6e3fce2d4709cecbe6af90909ad99ed9a3c7ba1cd97429a68f82abc8c085cd559251f74065cdd63874d183910c999d27d93b4f060f4e68f385c"
        );

        assertEq(uint256(faultProof.getChallenge(0).winner), uint256(ChallengeActor.CHALLENGER));
        assertEq(faultProof.getChallenge(0).resolved, true);
    }

    // Submitter correctly computed the ONNX operators. Challenger says the output is incorrect, but cannot complete the challenge.
    function test_ChallengeFail() public {
        // respond inference (wrong output)
        modelRegistry.respondInference(
            0,
            hex"4a1c883e4892983e79a1a9bd8d289ebefa1f7ebe6234f43deb8a433eae4c85bec73b3e3ddcf11ebe266d0ebec2e9b53ebc5df1bd61b0fabe0dc74e3e9e8158be32b86c3d3ce0d1bd515b013db4d9433df80ebcbc8bfcd53dfc6d53be8378c9bd3ff9173d1e32fa3ca81f3dbe22cc953e5faaa23d1fa682be22b126bdd3362c3d06dd983ef0ca39bee8a62d3c051e8b3e072fcfbc2e7ffabd74e9d93d6e15083d0efcb0be840b76bc09ea603cd4aa763d3cc7cd3c9c0eff3d0aa1013ecdc70a3e11b8e5bc702a73bd31f0373f027e363eeaf5803e1134e0bea739a4bdeecc633e2ba6533d34deb43d823244bf327ed63da0a0e03d507e85be61c80b3d82d4fe3d4888c7bd1c9e77bc4f3abcbcb8233bbcd4f1adbe17c11d3ea4cc31bd1630a1bcf0c2d0bd7c2592be9d2c7ebe0b4d81bc9e5521be2b3bc4bd0f50bf3dda60923eee321dbc75253cbeac76ed3d9bbed23d40063fbbd88d47be682a403ec140ad3d385d48bd60e3123e34b7f03ea869ba3d8e22e03c5bd1283ee0ecefbdd800363d7e8a003e8445903eda0afbbd0ae13d3e",
            bytes32(0x86e1c59c8509db81bd563c58bb57d487f9cb8f23a1bc4d2b4cf6614977fa94d7)
        );

        // create challenge - CHALLENGER
        faultProof.createChallenge(0);

        // propose operator execution - CHALLENGER (operator 2)
        faultProof.proposeOperatorExecution(
            0,
            bytes32(0x95541f66f0e41e0c1171aa42ec191eca98a6d903132fb5c56247999d5d1c846b),
            bytes32(0x6d3164945367c04f13830f4ba37d644bdcc907e0144241a03a0b2eddac1402c4)
        );

        // respond operator execution - SUBMITTER
        faultProof.respondOperatorExecution(0, true, true);

        // propose operator execution - CHALLENGER (operator 3)
        faultProof.proposeOperatorExecution(
            0,
            bytes32(0x6d3164945367c04f13830f4ba37d644bdcc907e0144241a03a0b2eddac1402c4),
            bytes32(0x5eeb0b5a8234f400165fa0420bcddf71e1de0b7496b6e5ef7df5b7f643b12aef)
        );

        // respond operator execution - SUBMITTER
        faultProof.respondOperatorExecution(0, true, true);

        // propose operator execution - CHALLENGER (operator 4)
        faultProof.proposeOperatorExecution(
            0,
            bytes32(0x5eeb0b5a8234f400165fa0420bcddf71e1de0b7496b6e5ef7df5b7f643b12aef),
            bytes32(0x86f1c59c8509db81bd563c58bb57d487f9cb8f23a1bc4d2b4cf6614977fa94d7)
        );

        // respond operator execution - SUBMITTER
        faultProof.respondOperatorExecution(0, true, false);

        // resolve challenge - CHALLENGER
        vm.expectRevert();
        faultProof.resolveOpenChallenge(
            0,
            hex"f0c4b404383d6a9cf9cd220237b3c5dad9e410e7fdca48ac58f66e94b5c31624010000000000000004000000000000005eeb0b5a8234f400165fa0420bcddf71e1de0b7496b6e5ef7df5b7f643b12aef86e1c59c8509db81bd563c58bb57d487f9cb8f23a1bc4d2b4cf6614977fa94d7",
            hex"1b34fe112bee0c1c35a5ecdb9ebd642daf0decdefeb1c6aca62a1db8e4b5383b0ac1af640de847996e6ae1ad338bcec384c77ba952fc51fbce7eab613056c891d9d2f23f1ff14c8d0c19668e549bcaf31c789cf949a1d0c67eb0c26e1cff7f11166779991bc8cdb7e740bee0b3c6363f24e3e73acd8696417e6f2cf8469d04a5ee6153c72ddecbd83359bdf000c09572dac0f6af28e08b797ea4b17be9ed31dbce8802f819982e471bf5cd12a3df7fab1242801d267092009ae9b71ccff5bf7b89e5ee712234d8064f068dba8de85fb6f9640bcef3bdd28b96db8c5d251f67d153a0d3fd2476f06ac69581be875e36f4e40d883d9bf68ce5449a84c7c2a2da98ff1081230adb607728220d42754aab35855cf3f046106543bc92984f6fad9d0af54623eb294fab0cff1a079d635307e455281acebe658a8ce1aa11a8ecc56ee98f4617732ad04d283026c5b97dba5bb90d805e03e4eb5105385c412b3f334833556640d81e35402464e153148d93d14eb8179d8a22e46399230e43bca63790313b8008a81ecde068d7466bbe0bf56bc5ae7de081df2660a310b175f06d9e8e0af0b6d96d08ede25c89b1420ccdfcf0761a264741c13d56d48e5b15532db3d4f48001c31c09eac867028abb907dc3f455a5ed23cc5563f3478fadc42a8749e872f27b462903e19a086addfa88c4a70ade994927e9b14ab42c36b5914ff6370e5a783dd0a6182beb5b719c8e62b023977e9bc5bd46f4b7190f608fcabc28e803fc9f382bad0067aadb0c749920b9c9accff058e57ce2d691ea6ed48a0fd3ac0c212ec6d9511f02fa87a6b52dfdab7c1d46155622605f700c1492da3eded094c2f2f753abd72c92f8ecfb9373856a1206a732dcda7e81fe108d5e39d690cdaccaa982ed8ff42fbf9011aa0648754dd803e605112eec102e9e04da225640058fe19ca2845fc41d97e8294b1a93e2508228dce5ed730a5aaf0f13a11b9d2bc6cb4a3687eaf56317ce54844d8eb4f1c7a16ff2be9757a27c4ae737fa0d290de88fce278b3dec281b206313e36699bc7653dd5ae92d351f33aaf7386c84b73d82368dcf00b5217723e312e9dc67742efe7ee7fdb407d4e05261be3e0173a3be65a0d3b2ae3e54cd25fb98ae70fe296d9479e4b72e8023c3b2cace7b414661d2d6eda46e8df7cbb01820c12f3bc74010eabd36597ccb6333f0ed68b3fe02421f0335dcbc8f9f071e"
        );

        vm.warp(vm.getBlockTimestamp() + 1 weeks);

        // resolve expired challenge - SUBMITTER
        faultProof.resolveExpiredChallenge(0);

        assertEq(uint256(faultProof.getChallenge(0).winner), uint256(ChallengeActor.RESPONDER));
        assertEq(faultProof.getChallenge(0).resolved, true);
    }

    // function test_FaultProofStep0() public {
    //     // respond inference (wrong output)
    //     modelRegistry.respondInference(
    //         1,
    //         hex"7b226f7574707574223a7b226474797065223a22463332222c22646576696365223a22437075222c227368617065223a5b312c3130305d2c2264617461223a5b302e31323333333834343630323130383030322c302e31373438373838353035373932363137382c2d302e31343331373439363132303932393731382c2d302e31313336353836323933353738313437392c302e30343938353335353935383334323535322c302e30313937363434313936343530373130332c2d302e30343632303335313236393834313139342c302e30323133303432303133333437313438392c302e313433303637383831343634393538322c302e31343632353733343039303830353035342c302e31303037303733323233353930383530382c2d302e303239303731383637343635393732392c2d302e30393339383734303533303031343033382c2d302e3036313332313235383534343932313837352c302e31343136313431393836383436393233382c302e30353631313739303334343131393037322c302e3030373838363433333937333930383432342c2d302e303135323830383237383739393035372c2d302e3032373939333931303031343632393336342c302e3032313132333933363339393831373436372c2d302e313338353834343334393836313134352c2d302e3031383438323230343532363636323832372c2d302e30333130363539343634343438363930342c2d302e31303730383438393236393031383137332c302e30373231363238323138383839323336352c2d302e30383631363730383936343130393432312c302e3034373331363335333736383131303237352c302e3030333530353532373937333137353034392c302e31353635323539333937303239383736372c2d302e31303333313437353733343731303639332c2d302e30333539383531313231393032343635382c2d302e30393834363734383431313635353432362c2d302e30333633353034303637303633333331362c302e30383338313938383835333231363137312c302e323138363636393236303236333434332c302e30393739313036333531373333323037372c2d302e30393835383235363537383434353433352c2d302e3030353434313437303037313637333339332c302e303034323530363937373931353736333835352c2d302e303030373635373434353936373139373431382c2d302e31313135353838393932383334303931322c302e30333536313635363137373034333931352c2d302e30393139313536313439303239373331382c302e30323339343838333532303930313230332c302e30303030383633353539353434303836343536332c2d302e3030363634363636323935303531353734372c302e3032303938343833393634383030383334372c2d302e313638333639363036313337323735372c2d302e30343536343230343831323034393836362c302e31373835393837343636353733373135322c302e323435383933393430333239353531372c302e31353330373531343336393438373736322c302e30363933303832373334393432343336322c2d302e3034393430373638333331323839323931342c2d302e30393833383237303339353939343138362c302e30363930333539313030363939343234372c2d302e3032373039353530343130353039313039352c302e3031313838353237343230313633313534362c2d302e30383430313834333136303339303835342c302e3031343431363932353630393131313738362c302e30363837343639393134353535353439362c2d302e323233303836313333353939323831332c302e32343533393035333434303039333939342c2d302e303337333434333134313537393632382c302e3035303336343437353639373237383937362c2d302e3136333538333434323536383737392c2d302e30363935393939373131373531393337392c302e3031363239323434353336313631343232372c302e30353737353931363230333835363436382c302e3034353432303630353638393238373138362c2d302e3032313930303531393732383636303538332c2d302e30303033373135383030313231343236353832332c2d302e30383433383335373731303833383331382c302e30333932303432313734393335333430392c2d302e31323132393833373237343535313339322c2d302e30353331323430333636333939323838322c2d302e32343631303731373539343632333536362c302e303437343339303930393037353733372c302e31323139393433323430323834393139372c302e3032373631343330323933333231363039352c2d302e3236363233393733323530333839312c2d302e31393832353034353736343434363235392c302e313031353134303536333234393538382c302e313133353437393133373330313434352c302e30343231373335373536303939323234312c302e3031343335393036343430303139363037352c2d302e30373730363231323939373433363532332c2d302e3031333734393631383038333233383630322c2d302e30383038323537333131353832353635332c302e3031343632393535343030333437373039372c302e30383731303231313531353432363633362c2d302e30383934303038313239383335313238382c2d302e31303531343238393134303730313239342c302e31333138343831383632353435303133342c302e30383038313136343231313033343737352c302e3031303335363231303137323137363336312c2d302e3035353030313435363239303438333437352c2d302e30313332363637343232323934363136372c2d302e303031363430353834333139383239393430382c302e30353334343230363833393739393838315d7d7d",
    //         bytes32(0x92bcc8caabd69e3f0c3f7f959727f0ce9164329d00d67bce041ba931a0380264)
    //     );

    //     // create challenge - CHALLENGER
    //     faultProof.createChallenge(1);

    //     // propose operator execution - CHALLENGER (operator 2)
    //     faultProof.proposeOperatorExecution(
    //         0,
    //         bytes32(0x36cfeff769ec13767dd396d6a5c8c4f69972217b0be40229bb67ac25562bdc24),
    //         bytes32(0x89ae55f5850e4f5040c5bec141325805a3abaa009319d633cdece0396705451f)
    //     );

    //     // respond operator execution - SUBMITTER
    //     faultProof.respondOperatorExecution(0, false, false);

    //     // propose operator execution - CHALLENGER (operator 0)
    //     faultProof.proposeOperatorExecution(
    //         0,
    //         bytes32(0xbe7c9f3b068911bc4e4f0a92253667a8661b250d2f82cc6f402efd7563939834),
    //         bytes32(0x24653d6633fc3eb3277a9d7a8e6e6567ec75cfe60740a65a1b541223d5c63623)
    //     );

    //     // respond operator execution - SUBMITTER
    //     faultProof.respondOperatorExecution(0, true, false);

    //     // resolve challenge - CHALLENGER
    //     faultProof.resolveOpenChallenge(
    //         0,
    //         hex"f0c4b404383d6a9cf9cd220237b3c5dad9e410e7fdca48ac58f66e94b5c3162401000000000000000000000000000000be7c9f3b068911bc4e4f0a92253667a8661b250d2f82cc6f402efd756393983424653d6633fc3eb3277a9d7a8e6e6567ec75cfe60740a65a1b541223d5c63623",
    //         hex"1b34fe1121d87bd45c118521fa84473c4db5df26542ca4dbd93ed385738b80343f1cf6d31a4c5d8ae90d7ae87128e8c943c00d06a0c1b99c0cd8f87fb1cd3b3f2874ff1917c672d5dac2cd6bb3f2ca436465eddb77bd32a8889cd4c3b531da2a43f41e4512fa3bcc527bc9ecc05f703b6efe3c0aee1eb6b3643a8698f568fd4c0747837d23233bf0039c32a52bc6ad9439fbb18cbe684901388b460eecfed6c8d07928c702e8c34b37da788ebd591d1fc22b74bf967a62eccad510e5ca7795cc68b5ad5f10157785b739c366b9d4af5a0b442e67451d78d9e3c597d8ac57af92ee0c8fc508f4da42ce0cbf1f7ac1892afc4da430a926f70bc45c52d2ec8169db10ce57d709b3ff53b78b1892090b6133ab0067c66297e7f69d5ef8706fe00a9fafb3bc021b6a6f5237821d90b79ad995b43bd54abb990b3fdbf5bf6b920687a601a4626d0b99d2b400cb1d73469a6328c1d9678c09f4d9093a5303cc862cc5b220e9d16212d55acfc6eac6de9252b3e35b0854651eca05a8b4b29dd328467edc6675445e1b582d61aa33929577ee0f13ef9e8f4338a013c4610c9b2b0c2fe47b1aa80a2328c89a0da912e6c0780a678bd7f6dea1ff9537aab6a25f2324b6ea36076488b71ec356b2b015c9d556f71ad7185ab85b979d0d0d40b1d7a5826a0f599c22a485077a424018d368e772bf4b23318393df97907840049a6b9e37b6b4d7e2a38ea00bb8bb109aa207a5eab353841c76114042be008188d42256f12f29b26b332d2513d16bed76ea9508edae02d5dcd044968601ef7b595688e85e0d5676bbadbedb0c4007f479b1b092c05b38d5d1a9b1550e603d29b50d7af814f6dfd6013297aa11651d797c887157bcd9eacc1dd8546b479fda63c2872331eca5bdcc89d2927c1efd00f124e3fd9a49108ac47c9decb7cbeb38513313b680289f5039964d4c12144e7a48307abb46a5f670a4142a29b4226b449d993c2a58aa035bd200d2b7791ddb4684ff390528b9a9ee0ab16071d7cb1f0de60e574cc3a98fc50d4fd6f0c41e8b4e82466dd77f4465d3879ce1591e4462b8dade8ff8f6986bf85767f2b8ca03dd80a4ea788e868a5d1328e747d186f98a435e9a0fe12cdd2fe0a05407707f16932647bf8c8c8174147c600195761ac422d3934c65cd93f6b53b80939a33ac2dd0ae68322571ef1b1269d3cf1b4105e8e111d0c3e25b76101d7b2581375f82"
    //     );

    //     assertEq(uint256(faultProof.getChallenge(0).winner), uint256(ChallengeActor.CHALLENGER));
    //     assertEq(faultProof.getChallenge(0).resolved, true);
    // }
}
